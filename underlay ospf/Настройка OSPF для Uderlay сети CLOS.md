### 					  						Uderlay сеть СLOS  (конфигурация OSPF)	



#### Схема сети:

![](https://github.com/dmn111/otus1/blob/master/Cx%D0%B5%D0%BC%D0%B0%20Underlay%20%D1%81%D0%B5%D1%82%D0%B8%20CLOS.PNG)

#### Описание сети

Сеть представляет собой два  датацетра  A и B в каждом из которых размещены двухуровневые clos.  IP свзяность между datacenter обеспечивается через WAN маршрутизатор R15 на котором запущены два ospf процесса для каждого ЦОД с редистрибьюцией суммарных префиксов ЦОД 10.77.0.0/16 (A)  и 10.66.0.0/16 (B).  Для уменьшения времени установлениея ospf соседства между устройствами, на ethernet интерфейсе явно используются тип ospf сети point-to-point ( что исключает необходимомость выбора DR/BDR).

#### Адресное пространство

##### DataCenter A:   

вся сеть -10.77.0.0/16,   

интерфейсы loopback  - 10.77.255.0/24, 

интерфейсы p2p  для spine1  - 10.77.1.0/24 

интерфейсы p2p  для spine2  - 10.77.2.0/24 

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  a-nxos-sp1  | loopback1 | 10.77.255.1/32 |
|              | e1/1      | 10.77.1.13/30  |
|              | e1/2      | 10.77.1.1/30   |
|              | e1/3      | 10.77.1.5/30   |
|              | e1/4      | 10.77.1.9/30   |


| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  a-nxos-sp2  | loopback1 | 10.77.255.2/32 |
|              | e1/1      | 10.77.2.13/30  |
|              | e1/2      | 10.77.2.1/30   |
|              | e1/3      | 10.77.2.5/30   |
|              | e1/4      | 10.77.2.9/30   |

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  a-nxos-lf3  | loopback1 | 10.77.255.3/32 |
|              | e1/1      |                |
|              | e1/2      | 10.77.1.2/30   |
|              | e1/3      | 10.77.2.6/30   |
|              | e1/4      |                |

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  a-nxos-lf4  | loopback1 | 10.77.255.4/32 |
|              | e1/1      |                |
|              | e1/2      | 10.77.2.2/30   |
|              | e1/3      | 10.77.1.6/30   |
|              | e1/4      |                |

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  a-nxos-lf7  | loopback1 | 10.77.255.7/32 |
|              | e1/1      |                |
|              | e1/4      | 10.77.1.10/30  |
|              | e1/5      | 10.77.2.10/30  |

##### DataCenter  B:   

вся сеть -10.66.0.0/16, 

интерфейсы loopback  - 10.66.255.0/24, 

интерфейсы p2p  для spine1 - 10.66.1.0/24 

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  b-nxos-sp1  | loopback1 | 10.66.255.1/32 |
|              | e1/1      | 10.66.1.1/30   |
|              | e1/2      | 10.66.1.10/30  |

| Оборудование | Интерфейс | Ip адрес       |
| :----------: | --------- | -------------- |
|  b-nxos-lf1  | loopback1 | 10.66.255.2/32 |
|              | e1/1      | 10.66.1.11/30  |
|              | e1/2      | switchport     |

##### WAN: 

| Оборудование | Интерфейс | Ip адрес        |
| :----------: | --------- | --------------- |
|     R15      | loopback1 | 10.77.255.15/32 |
|              | e0/0      | 10.77.1.14/30   |
|              | e0/1      | 10.77.2.14/30   |
|              | e0/2      | 10.66.1.2/30    |
|              |           |                 |



##### Конфигурация оборудования :

[a-nxos-sp1](https://github.com/dmn111/otus1/blob/master/a-nxos-sp1.conf.md)

[a-nxos-sp2](https://github.com/dmn111/otus1/blob/master/a-nxos-sp2.conf.md)

[a-nxos-lf3](https://github.com/dmn111/otus1/blob/master/a-nxos-lf3.conf.md)

[a-nxos-lf4](https://github.com/dmn111/otus1/blob/master/a-nxos-lf4.conf.md)

[a-nxos-lf7](https://github.com/dmn111/otus1/blob/master/a-nxos-lf7.conf.md)

[b-nxos-sp1](https://github.com/dmn111/otus1/blob/master/b-nxos-sp1.conf.md)

[b-nxos-lf1](https://github.com/dmn111/otus1/blob/master/b-nxos-lf1.conf.md)

